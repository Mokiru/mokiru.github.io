---
title: Probability Theory
date: 2025-04-06 05:00:00 +0800
categories: [MachineLearning, Math]
tags: [study]     # TAG names should always be lowercase
author: momochi
# authors: [xx,xx]
description: 基础概率论
comments: true # 评论
pin: false # top 
math: true
---

## 随机事件与概率

### 随机事件及其运算

#### 随机试验

在一定条件下必然发生，称其现象为确定性现象，比如偶数必然能被2整除，而在另外一些现象中，事先无法预知出现哪个结果，因此称这类现象为随机现象，随机现象在一次试验中呈现不确定的结果，而在大量重复试验中结果呈现某种规律性，这种规律性成为统计规律性。而为了研究这种规律性，就要对客观事物进行观察，其过程叫随机试验。随机试验有以下三个特点：
1. 相同条件下，试验可以重复进行
2. 每次试验的结果不止一种，但是试验之前必须明确试验的所有可能结果
3. 每次试验将会出现什么样的结果事先是无法预知的

#### 样本空间

随机试验的一切可能结果组成的集合成为**样本空间**，记为 $$\Omega=\{\omega\}$$ 其中 $$\omega$$ 表示试验的每一个可能结果，又称为**样本点**， 即样本空间为全体样本点的集合

#### 随机事件

当我们通过随机试验来研究随机现象时，每一次试验都只能出现 $$\Omega$$ 中的某一个 $$\omega$$ ，各个可能结果 $$\omega$$ 是否在一次试验中出现是随机的，在随机试验中，常常会关心其中某一些结果是否出现，例如抛掷骰子，关心掷出的点是否是奇数，这在一次试验中可能出现，也可能不出现的一类结果称为**随机事件**，随机事件通常使用大写字母A，B，C，...表示。

上述例子，可以定义 $$A="掷出骰子是奇数"$$ 可以将其描述为 $$A=\{1,3,5\}$$ ，它是样本空间 $$\Omega=\{1,2,3,4,5,6\}$$ 的一个子集，所以从集合角度来说，样本空间的部分样本点组成的集合成为随机事件

综上，给出以下概念：

1. 任一随机事件A是样本空间 \$$\Omega$$ 的一个子集
2. 当试验结果 \$$\omega$$ 属于该子集时，就说明事件A发生了，反之不属于则没有发生
3. 仅含有一个样本点的随机事件称为基本事件
4. 样本空间 \$$\Omega$$ 也是自己的一个子集，又因为其包含所有可能结果，因此在每一次试验当中必然发生，又称其为必然事件
5. 空集 \$$\emptyset$$ 也是样本空间的一个子集，由于不包含任何元素，因此在每一次试验中一定不发生，又称为不可能事件

#### 随机事件间的关系与运算

和集合一样，具有并、交、差和余四种运算：

1. \$$A\bigcup B$$ 由事件A和事件B所有样本点组成的新事件，表示事件A和事件B至少有一个发生
2. \$$A\bigcap B$$ 由事件A和事件B中的公共样本点组成的新事件，表示事件A和事件B同时发生
3. \$$A-B$$ 由在事件A中且不在事件B中的样本点组成的新事件，表示事件A发生且事件B不发生
4. \$$\overline{A}$$ 由 在$$\Omega$$ 中且不在事件A中的所有样本点组成的新事件，表示事件A不发生，称其为事件A的对立事件

由此，我们可以总结以下结论：

1. 对立事件一定是互不相容的事件，即 \$$A\bigcap \overline{A}=\emptyset$$，但是互不相容事件不一定是对立事件
2. 事件A和事件B的差还可以表示为： \$$A-B=A\bigcap \overline{B}$$
3. 必然事件和不可能事件互为对立事件

### 概率的定义及其性质

在 $$n$$ 次试验中，如果事件A出现了 $$n_{A}$$ 次，则称比值 $$\frac{n_{A}}{n}$$ 为这 $$n$$次试验中事件A出现的频率，记作 $$f_{n}(A)=\frac{n_{A}}{n}$$，$$n_{A}$$称为事件A发生的频数，概率的统计定义为：随着试验次数 $$n$$的增大，频率值逐步“稳定”到一个实数，这个实数称为事件A发生的概率。概率的公理化定义如下：

设任一随机试验 $$E$$ ，$$ \Omega$$ 为相应的样本空间，若对任意事件 $$A$$，有唯一实数 $$P(A)$$ 与之对应，且满足下面条件，则数 $$P(A)$$称为事件 $$A$$的概率:
1. 非负性公理：对于任意事件 \$$A$$，总有 \$$P(A)\geq 0$$
2. 规范性公理： \$$P(\Omega)=1$$
3. 可列可加性公理：若 \$$A_1,A_2,...,A_n$$ 为两两互不相容的事件，则有 \$$P(\bigcup_{i=1}^{\infty}A_i)=\sum_{i=1}^{\infty} P(A_i)$$

由概率的三条公理，可以得到以下概率的一些基本性质：

性质1：$$P(\emptyset)=0$$。证明：由可列可加性公理，不妨取 $$A_i=\emptyset,i=1,2,3,...$$ 则 $$P(\emptyset)=P(\bigcup_{i=1}^{\infty}A_i)=\sum_{i=1}^{\infty}P(A_i)=\sum_{i=1}^{\infty}P(\emptyset)$$，由非负性公理，$$P(\emptyset)\geq 0$$，因此由上述可得 $$P(\emptyset)=0$$。

性质2：有限可加性，设 $$A_1,A_2,...,A_n$$ 为两两互不相容的事件，则有 $$P(\bigcup_{i=1}^{n}A_i)=\sum_{i=1}^{n}P(A_i)$$。证明：在可列可加性公理中，不妨取 $$A_i=\emptyset,i=n+1,n+2,...$$ 则 $$P(\bigcup_{i=1}^{n}A_i)=P(\bigcup_{i=1}^{\infty}A_i)=\sum_{i=1}^{\infty}P(A_i)=\sum_{i=1}^{n}P(A_i)+\sum_{i=n+1}^{\infty}P(A_i)=\sum_{i=1}^{n}P(A_i)$$

性质3：对任意事件 $$A$$，有 $$P(\overline{A})=1-P(A)$$。证明：因为事件 $$A$$与 $$\overline{A}$$ 互不相容，且 $$\Omega=A\bigcup \overline{A}$$，由规范性公理和性质2可知，$$P(\Omega)=P(A)+P(\overline{A})=1$$

性质4：若事件 $$A\subset B$$，则 $$P(B-A)=P(B)-P(A)$$。证明：因为事件 $$A\subset B$$，所以$$B=A\bigcup(B-A)$$，且 $$A$$与 $$B-A$$互不相容，由性质2有限可加性得 $$P(B)=P(B-A)+P(A)$$

性质5：减法公式，设 $$A,B$$为任意事件，则 $$P(A-B)=P(A)-P(AB)$$。证明：$$A-B=A-AB$$，且 $$AB\subset A$$，由性质4可得 $$P(A-B)=P(A-AB)=P(A)-P(AB)$$

性质6：加法公式，设 $$A,B$$为任意事件，则 $$P(A\bigcup B)=P(A) + P(B) - P(AB)$$。证明：因为$$A\bigcup B=A\bigcup (B-AB)$$，且 $$A$$ 与 $$B-AB$$ 互不相容，由性质2可得 $$P(A\bigcup B)=P(A)+P(B-AB)=P(A)+P(B)-P(AB)$$
更一般地，设 $$A_1,A_2,...,A_n$$ 为任一的 $$n$$ 个事件，则 $$P(\bigcup_{i=1}^{n}A_i)=\sum_{i=1}^{n}P(A_i)-\sum_{1\leq i\leq j\leq n}P(A_iA_j)+\sum_{1\leq i\leq j\leq k\leq n}P(A_iA_jA_k) +...+(-1)^{n+1}P(A_1A_2...A_n)$$

### 等可能概型



## 名词解释

- 概率密度函数：描述随机变量的输出值在某个确定的取值点附近的可能性的函数，对于一个一维实随机变量 $X$ ，设它的累积分布函数是 $$F_X(x)$$ ，如果存在可测函数 $$f_X(x)$$ ，满足 $$F_X(x)=\int^x_{-\infty}f_X(t)dt$$ ，那么 $$X$$ 是一个连续型随机变量，并且 $$f_X(x)$$ 是它的概率密度函数
- 概率分布函数：描述随机变量取值分布规律的数学表示，对于任何实数 $$x$$ ，事件 $$X\lt x$$ 的概率当然是一个 $$x$$ 的函数。令 $$F(x)=P(X\lt x)$$ ，显然有 $$F(-\infty)=0,F(\infty)=1$$，称 $$F(x)$$ 为随机变量 $$X$$ 的分布函数，所以分布函数 $$F(x)$$ 完全决定了事件 $$a\leq X\leq b$$的概率，或者说分布函数 $$F(x)$$ 完整地描述了随机变量 $$X$$ 的统计特性 
- 联合密度函数：描述两个或两个以上随机变量之间联合分布特性的函数，如果将二维随机变量 $$(X,Y)$$ 看作是平面上随机点的坐标，那么分布函数 $$F(x,y)$$ 在 $$(x,y)$$处的函数值就是随机点 $$(X,Y)$$ 落在以点 $$(x,y)$$ 为顶点而位于该点左下方的无穷矩形域内的概率
- 先验分布函数：在进行统计试验之前，根据已有的知识和经验对参数 $$\theta$$ 的概率分布所做的假设，参数空间 $$(\Theta,B_{\Theta})$$ 上任一概率分布 $$\pi$$ 称为参数 $$\theta$$ 的一个先验分布。

## 全概率公式

如果事件$$B_1、B_2、B_3、....B_i$$构成一个完备事件组，即它们俩俩互不相容，其和为全集，并且$$P(B_i)$$大于0，则对任意事件$A$有：

$$
P(A)=P(A|B_1)P(B_1)+P(A|B_2)P(B_2)+P(A|B_3)P(B_3)+...+P(A|B_i)P(B_i)
$$


## 贝叶斯定理

比如精灵球分为三个等级，一共有200个，具体信息如下：

|等级|数量|捕捉成功概率|
|:---|:---|:---|
|1|140|0.99|
|2|40|0.80|
|3|20|0.40|

现在从其中任意选一个精灵球进行捕捉，结果捕捉失败了，那么该精灵球为各个等级的概率为多少？

首先我们知道总数和每个等级精灵球的个数，那么我们可以得到选中概率：

$$
P(选中1级)=0.7,P(选中2级)=0.2,P(选中3级)=0.1
$$

然后我们也知道不同等级精灵球捕捉成功的概率，那么我们就能知道：

$$
P(失败|选中1级)=0.01,P(失败|选中2级)=0.20,P(失败|选中3级)=0.60
$$

现在我们需要在已知捕捉失败的情况下知道不同等级的概率：

$$
P(选中1级|失败),P(选中2级|失败),P(选中3级|失败)
$$

根据全概率公式：

$$
P(A|B)=\frac{P(AB)}{P(B)}=\frac{P(B|A)\bullet P(A)}{P(B)}
$$

进一步，利用全概率公式，该式子变为：

$$
P(A|B)=\frac{P(B|A)P(A)}{P(B|A)P(A) + P(B|\overline A)P(\overline A)}
$$

如果S中对事件B的假定构成了互斥、完备的一组分划：$$A_1,A_2,A_3,...,A_n$$,且各事件概率均为正，那么有：

$$
P(A_i|B) = \frac{P(B|A_i)P(A_i)}{\sum^{n}_{j=1}P(B|A_j)P(A_j)}
$$

于是按照该结果，可以得到上述问题答案，以1级为例子：

$$
P(A_1|B)=\frac{P(B|A_1)P(A_1)}{\sum^{3}_{j=1}P(B|A_j)P(A_j)}=\frac{7}{107}
$$

设总体X有样本$$X_1,X_2,X_3,...,X_n$$，这些样本的联合密度函数为$$f(x_1,x_2,x_3,...,x_n;\theta)$$，其中$$\theta\in\Theta$$是未知参数，作为随机变量具有先验分布函数$$\pi(\theta)$$，在贝叶斯的观点下，样本的联合密度函数是在给定$$\theta$$下的条件密度函数，又称似然函数，即：

$$
L(x|\theta)=f(x_1,x_2,x_3,...,x_n;\theta)
$$

如果有抽样信息，就可以通过给定样本观察值情况下，参数$$\theta$$的条件密度函数，来对参数进行统计推断，即：

$$
\pi(\theta|x)=\frac{L(x|\theta)\pi(\theta)}{\int_{\Theta}L(x|\theta)\pi(\theta)d\theta}
$$

此即连续性随机变量形式的贝叶斯公式。

当$\theta$是离散型随机变量时，先验分布替换为先验分布律$$\pi(\theta_i)(i=1,2,3,....,n)$$，离散型随机变量形式的贝叶斯公式为：

$$
\pi(\theta_i|x)=\frac{L(x|\theta_i)\pi(\theta_i)}{\sum^{n}_{j=1}L(x|\theta_i)\pi(\theta_j)}
$$

在实际应用中，如果在试验前对参数了解不多，无法给出先验分布时，贝叶斯建议用均匀分布作为其先验分布