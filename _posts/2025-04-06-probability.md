---
title: Probability Theory
date: 2025-04-06 05:00:00 +0800
categories: [MachineLearning, Math]
tags: [study]     # TAG names should always be lowercase
author: momochi
# authors: [xx,xx]
description: 基础概率论
comments: true # 评论
pin: false # top 
math: true
---

## 随机事件与概率

### 随机事件及其运算

#### 随机试验

在一定条件下必然发生，称其现象为确定性现象，比如偶数必然能被2整除，而在另外一些现象中，事先无法预知出现哪个结果，因此称这类现象为随机现象，随机现象在一次试验中呈现不确定的结果，而在大量重复试验中结果呈现某种规律性，这种规律性成为统计规律性。而为了研究这种规律性，就要对客观事物进行观察，其过程叫随机试验。随机试验有以下三个特点：
1. 相同条件下，试验可以重复进行
2. 每次试验的结果不止一种，但是试验之前必须明确试验的所有可能结果
3. 每次试验将会出现什么样的结果事先是无法预知的

#### 样本空间

随机试验的一切可能结果组成的集合成为**样本空间**，记为 $$\Omega=\{\omega\}$$ 其中 $$\omega$$ 表示试验的每一个可能结果，又称为**样本点**， 即样本空间为全体样本点的集合


## 名词解释

- 概率密度函数：描述随机变量的输出值在某个确定的取值点附近的可能性的函数，对于一个一维实随机变量 $X$ ，设它的累积分布函数是 $$F_X(x)$$ ，如果存在可测函数 $$f_X(x)$$ ，满足 $$F_X(x)=\int^x_{-\infty}f_X(t)dt$$ ，那么 $$X$$ 是一个连续型随机变量，并且 $$f_X(x)$$ 是它的概率密度函数
- 概率分布函数：描述随机变量取值分布规律的数学表示，对于任何实数 $$x$$ ，事件 $$X\lt x$$ 的概率当然是一个 $$x$$ 的函数。令 $$F(x)=P(X\lt x)$$ ，显然有 $$F(-\infty)=0,F(\infty)=1$$，称 $$F(x)$$ 为随机变量 $$X$$ 的分布函数，所以分布函数 $$F(x)$$ 完全决定了事件 $$a\leq X\leq b$$的概率，或者说分布函数 $$F(x)$$ 完整地描述了随机变量 $$X$$ 的统计特性 
- 联合密度函数：描述两个或两个以上随机变量之间联合分布特性的函数，如果将二维随机变量 $$(X,Y)$$ 看作是平面上随机点的坐标，那么分布函数 $$F(x,y)$$ 在 $$(x,y)$$处的函数值就是随机点 $$(X,Y)$$ 落在以点 $$(x,y)$$ 为顶点而位于该点左下方的无穷矩形域内的概率
- 先验分布函数：在进行统计试验之前，根据已有的知识和经验对参数 $$\theta$$ 的概率分布所做的假设，参数空间 $$(\Theta,B{\Theta})$$ 上任一概率分布 $$\pi$$ 称为参数 $$\theta$$ 的一个先验分布。

## 全概率公式

如果事件$$B_1、B_2、B_3、....B_i$$构成一个完备事件组，即它们俩俩互不相容，其和为全集，并且$$P(B_i)$$大于0，则对任意事件$A$有：

$$
P(A)=P(A|B_1)P(B_1)+P(A|B_2)P(B_2)+P(A|B_3)P(B_3)+...+P(A|B_i)P(B_i)
$$


## 贝叶斯定理

比如精灵球分为三个等级，一共有200个，具体信息如下：

|等级|数量|捕捉成功概率|
|:---|:---|:---|
|1|140|0.99|
|2|40|0.80|
|3|20|0.40|

现在从其中任意选一个精灵球进行捕捉，结果捕捉失败了，那么该精灵球为各个等级的概率为多少？

首先我们知道总数和每个等级精灵球的个数，那么我们可以得到选中概率：

$$
P(选中1级)=0.7,P(选中2级)=0.2,P(选中3级)=0.1
$$

然后我们也知道不同等级精灵球捕捉成功的概率，那么我们就能知道：

$$
P(失败|选中1级)=0.01,P(失败|选中2级)=0.20,P(失败|选中3级)=0.60
$$

现在我们需要在已知捕捉失败的情况下知道不同等级的概率：

$$
P(选中1级|失败),P(选中2级|失败),P(选中3级|失败)
$$

根据全概率公式：

$$
P(A|B)=\frac{P(AB)}{P(B)}=\frac{P(B|A)\bullet P(A)}{P(B)}
$$

进一步，利用全概率公式，该式子变为：

$$
P(A|B)=\frac{P(B|A)P(A)}{P(B|A)P(A) + P(B|\overline A)P(\overline A)}
$$

如果S中对事件B的假定构成了互斥、完备的一组分划：$$A_1,A_2,A_3,...,A_n$$,且各事件概率均为正，那么有：

$$
P(A_i|B) = \frac{P(B|A_i)P(A_i)}{\sum^{n}_{j=1}P(B|A_j)P(A_j)}
$$

于是按照该结果，可以得到上述问题答案，以1级为例子：

$$
P(A_1|B)=\frac{P(B|A_1)P(A_1)}{\sum^{3}_{j=1}P(B|A_j)P(A_j)}=\frac{7}{107}
$$

设总体X有样本$$X_1,X_2,X_3,...,X_n$$，这些样本的联合密度函数为$$f(x_1,x_2,x_3,...,x_n;\theta)$$，其中$$\theta\in\Theta$$是未知参数，作为随机变量具有先验分布函数$$\pi(\theta)$$，在贝叶斯的观点下，样本的联合密度函数是在给定$$\theta$$下的条件密度函数，又称似然函数，即：

$$
L(x|\theta)=f(x_1,x_2,x_3,...,x_n;\theta)
$$

如果有抽样信息，就可以通过给定样本观察值情况下，参数$$\theta$$的条件密度函数，来对参数进行统计推断，即：

$$
\pi(\theta|x)=\frac{L(x|\theta)\pi(\theta)}{\int_{\Theta}L(x|\theta)\pi(\theta)d\theta}
$$

此即连续性随机变量形式的贝叶斯公式。

当$\theta$是离散型随机变量时，先验分布替换为先验分布律$$\pi(\theta_i)(i=1,2,3,....,n)$$，离散型随机变量形式的贝叶斯公式为：

$$
\pi(\theta_i|x)=\frac{L(x|\theta_i)\pi(\theta_i)}{\sum^{n}_{j=1}L(x|\theta_i)\pi(\theta_j)}
$$

在实际应用中，如果在试验前对参数了解不多，无法给出先验分布时，贝叶斯建议用均匀分布作为其先验分布